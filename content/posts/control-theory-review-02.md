---
title: "自动控制原理 - 02 - 传递函数，典型环节与梅逊增益公式"
date: 2025-03-29T16:11:07+08:00
tags: ["2025-03", "学习笔记", "控制理论", "自动控制原理", "传递函数", "结构图", "梅逊增益公式"]
categories: ["自动控制原理"]
# description: "自动控制原理的学习笔记。"
toc: true
draft: true
---

之前主要复习了控制系统的一般概念，数学模型与拉普拉斯变换。本篇主要讲系统传递函数，从元部件微分方程到典型环节，以及使用梅逊增益公式计算系统输入/输出端口之间的闭环传递函数。

## 传递函数

在上一篇文章[自动控制原理 - 01 - 一般概念，数学模型与拉普拉斯变换]({{<siteurl>}}articles/2025/03/control-theory-review-01/)的[用拉普拉斯变换解微分方程]({{<siteurl>}}articles/2025/03/control-theory-review-01/#用拉普拉斯变换解微分方程)小节最后，我们稍微提到了传递函数的定义：

> **传递函数**是在**零初始条件**下，线性时不变系统输出量的拉普拉斯变换和输入量的拉普拉斯变换之比。

现在让我们来详细展开这个部分。

线性时不变系统的微分方程一般可写为

$$a_n \frac{\mathrm{d}^{n} c(t)}{\mathrm{d} t^{n}} + a_{n - 1} \frac{\mathrm{d}^{n - 1} c(t)}{\mathrm{d} t^{n - 1}} + ... + a_1 \frac{\mathrm{d}^ c(t)}{\mathrm{d} t} + a_0 c(t) = b_m \frac{\mathrm{d}^{m} r(t)}{\mathrm{d} t^{m}} + b_{m - 1} \frac{\mathrm{d}^{m - 1} r(t)}{\mathrm{d} t^{m - 1}} + ... + b_1 \frac{\mathrm{d}^ r(t)}{\mathrm{d} t} + b_0 r(t) \ ,$$

式中$c(t)$为输出量，$r(t)$为输入量，$a_n, a_{n - 1}, ..., a_1$及$b_m, b_{m - 1}, ..., b_1$均为由系统结构、参数决定的常系数。对于给定的输入信号$r_0 (t)$，将其代入到系统微分方程中即可得到有关系统输出$c_0 (t)$的一个微分方程；亦即，求解这个微分方程就能得到系统在输入信号$r_0 (t)$激励作用下产生的输出$c_0 (t)$。

对这个方程使用拉普拉斯变换，可以得到

$$a_n s^n C(s) + a_{n - 1} s^{n - 1} C(s) + ... + a_1 s C(s) + a_0 = b_m s^m R(s) + b_{m - 1} s^{m - 1} R(s) + ... + b_1 s R(s) + b_0 \ ,$$

按代数方法合并同类项，并按定义即可写出系统传递函数的表达式

$$G(s) = \frac{C(s)}{R(s)} = \frac{b_m s^m + b_{m - 1} s^{m - 1} + ... + b_1 s + b_0}{a_n s^n + a_{n - 1} s^{n - 1} + ... + a_1 s + a_0} \ .$$

这时，系统在输入$r_0 (t)$激励作用下产生输出$c_0 (t)$的拉普拉斯变换$C_0 (s)$就可以写成

$$C_0 (s) = R_0 (s) G(s) \ , $$

其中$R_0 (s)$是$r_0 (t)$的拉普拉斯变换。

对于不同的$r(t)$，都能够在拉普拉斯变换后通过传递函数计算出系统受其激励后产生的输出$C(s)$，再通过拉普拉斯反变换得到时域中的系统输出$c(t)$。

### 传递函数的性质

*这部分内容可以在教材P29页 2.3.1 传递函数 小节找到。*

- 传递函数是复变量$s$的有理分式函数，其具有复变函数的所有性质。
- 因为实际物理系统总是存在惯性，并且动力源功率有限，所以实际系统传递函数的分子阶次$m$总是小于或等于分母阶次$n$，即$m \leq n$。
- 传递函数只取决于系统或元部件自身的结构和参数，与外作用的形式和大小无关。
- 传递函数与微分方程有直接联系。复变量$s$相当于时域中的微分算子。
- 传递函数的拉普拉斯反变换即为系统的脉冲响应（即系统在单位脉冲信号$\delta(t)$激励下产生的输出）。

### 传递函数的局限性

- 传递函数是在零初始条件下定义的，因此它只能反映系统在零状态下的动态特性，不能反映非零初始条件下系统的全部运动规律。
- 传递函数通常只适合于描述单输入-单输出系统。
- 传递函数是由拉普拉斯变换定义的，拉普拉斯变换是一种线性变换，因此传递函数只适用于线性时不变系统（回忆一下傅里叶变换的特性，时域上的乘积等于频域上的卷积；当我们尝试对时变系统微分方程做拉普拉斯变换时将不得不处理对$a_k (t) x^{(k)} (t)$做变换的问题）。

### 传递函数的标准形式

传递函数的两种标准形式分别表现了系统的不同特征。

#### 首1标准型（零、极点形式）

将传递函数分子、分母最高次项（首项）的系数化为1，称为首1标准型；因式分解后也称为传递函数的零、极点形式。其表示如下

$$\displaystyle G(s) = \frac{K^* \prod_{j=1}^{m} (s - z_j)}{\prod_{i=1}^{n} (s - p_i)} = \frac{K^* (s - z_1)(s - z_2) ... (s - z_m)}{(s - p_1)(s - p_2) ... (s - p_n)} \ ,$$

式中，$z_1, z_2, ..., z_m$为令传递函数分子多项式为零时解出的$m$个根，称为传递函数的零点；$p_1, p_2, ..., p_n$为令传递函数分母多项式为零（也即系统的特征方程）时解出的$n$个根，称为传递函数的极点。此处的$K^*$称为根轨迹增益。虽然提到增益时我们一般指尾1标准型中的开环增益，但有必要了解根轨迹增益的概念。

将零、极点标在复数$s$平面上的图像，称为传递函数的零、极点图。零点通常用“$\circ$”表示，极点通常用“$\times$”表示。

零极点图揭示了关系统稳定性的基本信息。例如，如果系统中存在$s$平面右半部分的零点，则系统必然不稳定；如果系统。实际上这些都是根轨迹法分析系统性能要做的事情，我们将在后面的学习中详细讲解。

#### 尾1标准型（典型环节形式）

将传递函数分子、分母最低次项（常数项）的系数均化为1，称为尾1标准型；因式分解后也称为传递函数的典型形式。其表示如下

$$G(s) = K \frac{\prod_{k=1}^{m_1} (\tau_k s + 1) \prod_{l=1}^{m_2} (\tau_l^2 s^2 + 2 \zeta \tau_l s + 1)}{\prod_{i=1}^{n_1} (T_i s + 1) \prod_{j=1}^{n_2} (T_j^2 s^2 + 2 \zeta T_j s + 1)} \ ,$$

式中的每一个因子都对应一个典型环节。此处的K称为开环增益，或简称增益。

尾1标准型揭示了系统是由哪些典型环节组成的，在频率法分析系统性能时尤其有效。

开环增益$K$和根轨迹增益$K*$之间的关系如下：

$$K = \frac{K^* \prod_{j=1}^{m} |z_j|}{\prod_{i=1}^{n} |p_i|} \ .$$

## 典型环节

在控制系统中所用的元部件有电器的、机械的、液压的、光电的等等，种类繁多，工作机理各不相同，但若将其对应的传递函数抽象出来，却都可以看做是有限个基本单元的组合。我们称这些基本单元为典型环节。

|环节名称|微分方程|传递函数|举例|
|:-----:|:-----:|:-----:|:-:|
|比例环节|$c = K \cdot r$|$K$|电位器，放大器，减速器，测速发电机等|
|惯性环节|$T \dot{c} + c = r$|$\frac{1}{Ts+1}$|R-C电路，交、直流电动机等|
|振荡环节|$T^2 \ddot{c} + 2 \zeta T \dot{c} + c = r  \newline (0 < \zeta < 1)$|$\frac{1}{T^2 s^2 + 2 \zeta T s + 1}$|R-L-C电路，弹簧-质块-阻尼器系统等|
|积分环节|$\dot{c} = r$|$\frac{1}{s}$|电容上的电流与电压，测速发电机位移与电压等|
|微分环节|$c = \dot{r}$|$s$||
|一阶复合微分环节|$c = \tau \dot{r} + r$|$\tau s + 1$||
|二阶复合微分环节|$c = {\tau}^2 \ddot{r} + 2 \zeta \tau \dot{r} + r$|${\tau}^2 s^2 + 2\zeta \tau s + 1$||

上表来自卢京潮《自动控制原理》第35页 表2-1。

我们以振荡环节为例，分析一下为什么说典型环节是对不同系统基本单元的抽象。先来看R-L-C无源电网络的结构：

{{< figure
    src="https://z4a.net/images/2025/04/13/fc82756d0de5e9b3c3c9568d1ac01971.png"
    caption="R-L-C无源网络 卢京潮《自动控制原理》23页 图2-1"
    align=center
>}}

以复阻抗法对此电路进行分析，可以列写出电路方程：

$$
sLi(t) + Ri(t) + u_c (t) = u_r (t)
\newline \quad \newline
i = sCu_c (t) \ ,
$$

其中$R, L, C$分别为电阻的阻值、电感的电感量与电容的容值，系统对应的微分方程为

$$
L \dot{i} (t) + Ri(t) + u_c (t) = u_r (t)
\newline \quad \newline
i = C \dot{u_c} (t) \ ,
$$

联立并消去中间变量$i(t)$，得[^1]

$$LC \ddot{u_c} (t) + RC \dot{u_c} (t) + u_c (t) = u_r (t) \ .$$

而对于弹簧-质块-阻尼器系统的结构，可以列写出方程：

$$F(t) - f \dot{y} (t) - k y(t) = m \ddot{y} (t) \ ,$$

{{< figure
    src="https://z4a.net/images/2025/04/13/af003c8474346db04d03575ea107c919.png"
    caption="弹簧-质块-阻尼器系统 卢京潮《自动控制原理》24页 图2-2"
    align=center
>}}

即

$$\frac{m}{k} \ddot{y} (t) + \frac{f}{k} \dot{y} (t) + y(t) = \frac{1}{k} F(t) \ .$$

我们很快注意到，虽然R-L-C电网络与弹簧-质块-阻尼器系统是两种完全不同的系统，但描述它们的微分方程具有相同的形式；在对其进行拉普拉斯变换后，能够得到相同的方程（虽然弹簧-质块-阻尼器系统中输入侧存在$\frac{1}{k}$项，但由于其是常数，可以视作一个串联的比例环节，对系统的振荡性质无影响）：

$$T^2 s^2 C(s) + 2 \zeta Ts C(s) + C(s) = R(s) \ ,$$

系统的传递函数为

$$G(s) = \frac{C(s)}{R(s)} = \frac{1}{T^2 s^2 + 2 \zeta T s + 1} \ ,$$

此处式中的$\zeta$称为阻尼比，与系统的发散性和收敛速度有关；在后面学习典型二阶阻尼振荡系统时我们还会进一步展开。

可以看出，即使对于不同外在表现的系统，我们也可以将其抽象成典型环节进行描述分析。经典控制理论中研究的系统基本都是由典型环节串联而成，后续学习频率域分析方法时可以更深刻地感受到这一点。

## 结构图及其等效变换

*这部分内容来源于卢京潮《自动控制原理》36页 2.4 控制系统的结构图及其等效变换。*

系统结构图是描述组成系统的各元部件之间信号传递关系的图形化数学模型。

### 系统结构图绘制

系统结构图一般可通过两种途径建立：一是在得到系统方框图的条件下将每个方框中的元部件名称换成其对应的传递函数，并将所有变量用相应的拉普拉斯变换形式表示即得系统结构图；二是已知系统微分方程组的情况下将方程组中各子方程分别进行拉普拉斯变换，绘制出子方程的结构图，将子结构图组合即得系统结构图。

#### 从系统方框图绘制系统结构图

有了拉普拉斯变换这一工具，我们就可以按系统的实际结构与信号流向绘制其方框图后将方框图中每个子部分的传递函数求出，最终使用传递函数替代方框图中对应部分即得系统总的结构图。下面以函数记录仪控制系统方框图为例绘制其系统结构图。

{{< figure
    src="https://z4a.net/images/2025/04/19/9a6086d4b37d57d0d8db5f77aa17534f.png"
    caption="函数记录仪控制系统方框图 卢京潮《自动控制原理》37页 图1-9"
    align=center
>}}

将上图中各部分的传递函数求出，可以得到以下结构图：

{{< figure
    src="https://z4a.net/images/2025/04/19/53073e8285789cb3beb65e1d4eff094c.png"
    caption="函数记录仪控制系统结构图 卢京潮《自动控制原理》38页 图2-21"
    align=center
>}}

需要注意的是图中直流伺服电动机-测速发电机部分。对于一个电动机，其机械部分存在惯性，电气部分存在电感为等动态，因而并不能在对输入端施加电压后立即获得角速度输出，这部分一般被建模尾比例+惯性环节$\frac{K_m}{T_m s + 1}$的形式。

而对于实际的电动机，我们在对其施加电压后实际获得的是角位移的输出，也就是电机转子转动的角度$\theta_m$；角位移与角速度的关系为$\frac{\mathrm{d} \theta_m (t)}{\mathrm{d} t} = \omega_m (t)$，拉普拉斯变换后得$\Theta_m (s) = \frac{1}{s} \Omega_m (s)$，对应结构图中直流伺服电动机的两个部分。

对测速发电机而言，其输出的电压$u_{\omega} (t)$与电动机的转速$\omega_m (t)$成正比，因此在图中其输入来源于电动机惯性环节和积分环节之间的电动机角速度$\Omega_m (s)$。

在从系统方框图绘制系统结构图的过程中，很有必要弄清楚各个部分的输入信号来源与输出信号的去向，以及子部分的固有特性，如此才能绘制正确的结构图。

#### 从系统微分方程组绘制系统结构图

对于一个系统，我们可以写出其各个部分的微分方程，并通过消去子部分之间的信号（即中间变量）得到系统总的微分方程；在绘制系统结构图时我们则要保留中间变量和其意义。下面以电枢控制式直流电动机的微分方程组为例，从微分方程组绘制系统结构图。

系统微分方程组列出如下：

$$
\begin{cases}
u_a (t) = R \cdot i(t) + E_b (t)
\newline
E_b (t) = C_e \omega_m (t)
\newline
M_m (t) = C_m i(t)
\newline
J_m \dot{\omega}_m (t) + f_m \omega_m (t) = M_m (t)
\end{cases}
$$

其对应的传递函数组为

$$
\begin{cases}
\frac{I(s)}{U_a (s) - E_b (s)} = \frac{1}{R}
\newline \quad \newline
\frac{E_b (s)}{\Omega_m (s)} = C_e
\newline \quad \newline
\frac{M_m (s)}{I (s)} = C_m
\newline \quad \newline
\frac{\Omega_m (s)}{M_m (s)} = \frac{1}{J_m s + f_m}
\end{cases}
$$

可以画出以上各个环节的结构图

{{< figure
    src="https://z4a.net/images/2025/04/19/f439726b710d0987e0a3d7a8efeed94e.png"
    caption="直流电机各子部分结构图 卢京潮《自动控制原理》37页 图2-20(a)"
    align=center
>}}

把这些环节串联起来，即得直流电机系统的结构图

{{< figure
    src="https://z4a.net/images/2025/04/19/a61b716244156a317300bf69a2eebfaf.png"
    caption="直流电机系统结构图 卢京潮《自动控制原理》37页 图2-20(b)"
    align=center
>}}

不难看出来，从微分方程组绘制系统结构图与从系统方框图绘制系统结构图有异曲同工之妙；其区别在于系统微分方程组更直观地指出了系统不同部分的数学模型，只需对每一方程施加拉普拉斯变换即可得子部分的传递函数；而由系统方框图求各个子结构传递函数的过程被一笔带过了。

### 典型控制系统的结构图

在介绍结构图等效变换之前，我觉得有必要说明结构图与系统传递函数的关联。

{{< figure
    src="https://z4a.net/images/2025/04/19/dff88929adbc83b20711baa6c33b3cf1.png"
    caption="典型系统结构图 裴润《自动控制原理》34页图2.3.16"
    align=center
>}}

如图是一个典型的负反馈控制系统的结构图。其中由输入$R(s)$到输出$Y(s)$所经过的通路称为前向通路，前向通路上的传递函数$G_1 (s), G_2 (s)$乘总的$G(s) = G_1 G_2 (s)$[^2]是称为前向通路传递函数；从输出$Y(s)$将信息反馈到比较端参与比较的传递函数称为反馈通路传递函数，图中为$H(s)$；这个系统还受到了干扰输入$F(s)$的作用；但我们先假设$F(s) = 0$，也就是只考虑输入到输出的作用。

根据系统结构图可以列出传递函数方程组

$$
\begin{cases}
E(s) = R(s) - B(s)
\newline
B(s) = Y(s) H(s)
\newline
Y(s) = E(s) G_1 G_2 (s)
\end{cases}
$$

消去中间变量，可以得到

$$Y(s) = \frac{1}{1 + G_1 G_2 H (s)} R(s) \ ,$$

则系统传递函数为

$$\it{\large \Phi (s)} = \frac{Y(s)}{R(s)} = \frac{1}{1 + G_1 G_2 H (s)} = \frac{1}{1 + GH (s)} \ ,$$

$\it \Phi (s)$称为系统的闭环传递函数。闭环是与开环相对的，我们接下来马上会介绍到这个概念；但在此之前，我们可以很容易地看出闭环传递函数表达的是系统控制输入$R(s)$对系统输出$Y(s)$的作用。可以验证，对于任意负反馈控制系统，只要将其前向通路传递函数简化为$G(s)$，反馈通路传递函数简化为$H(s)$，那么这个控制系统的传递函数（从输入到输出）    就是

$$\it{\large \Phi (s)} = \frac{1}{1 + GH (s)} \ .$$

### 结构图等效变换

实际系统往往并不只有一条前向通路与一条反馈通路；大部分系中还存在内部反馈通路，这就为我们列写系统传递函数带来了很大麻烦。好在我们可以用结构图等效变换的方法将复杂结构图简化，从而应用上面的公式写出两个端口之间的传递函数。

#### 串联环节的等效变换

[^1]: 实际上也可以由电流$i$的定义：单位时间内通过导线某一截面的电荷量$q$得$i = \frac{\mathrm{d} q}{\mathrm{d} t}$，从而得$u_r (t) = L \ddot{q} (t) + R\dot{q}(t) + \frac{1}{C} q(t)$。虽然同样能得到描述系统的二阶常微分方程，但这种形式中$q(t)$与我们要研究的输出$u_c (t)$之间的关联并不明显，故不使用。

[^2]: 这里是$G_1 (s) G_2 (s)$的简记；需要注意的是我们现在正研究连续（模拟）控制系统，因此可以如此简记，在后面的章节涉及到离散（数字）系统时$G_1 (s) G_2 (s)$与$G_1 G_2 (s)$将具有不同的意义，应注意区分。
